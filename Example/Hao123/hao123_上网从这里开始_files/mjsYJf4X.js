define(["models/PlayListModel"],function(PlayListModel){var ListCtrl=Backbone.Model.extend({defaults:{playlist:new PlayListModel,playcore:null},initialize:function(options){options=options||{};this.set({playcore:options.playcore});var playlist=this.get("playlist"),playcore=this.get("playcore");playlist.on("change:curSong",function(playlist,curSong){this.trigger("change:curSong",this,curSong);playcore.stop();playcore.reset();if(curSong){if(curSong.hasLink){this.trigger("change:songLink",this,curSong);var url=curSong.get("songLink");playcore.setUrl(url);playcore.play()}else{playlist.fetchLink({success:_.bind(function(){this.trigger("change:songLink",this,curSong);playcore.setUrl(curSong.get("songLink"));playcore.play()},this)})}}},this);playcore.setEventListener(playcore.EVENTS.STATECHANGE,_.bind(function(event){var state=event.newState;switch(state){case playcore.STATES.END:this.trigger("playcomplete",this);playlist.autoNext();break}},this))}});return ListCtrl});
/** If u are interested in our code and would like to make it robust, just contact us^^  <enimong#gmail.com> **/
/** Generated by M3D. **/