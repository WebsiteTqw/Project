define(["ui/widget/jquery.ui.slider"],function(){var convertTime=function(time){var minute,second;time=Math.round(time/1e3);minute=Math.floor(time/60);second=time%60;minute=minute<10?"0"+minute:minute;second=second<10?"0"+second:second;return minute+":"+second};!function($,undefined){$.widget("ui.progressBar",{options:{model:null,totalTime:0,isSliding:false,showTime:true},_create:function(){this.playCore=this.options.model.get("playcore");this.playList=this.options.model.get("playlist");this._createProgressBar();this._bindEvent()},_createProgressBar:function(){this.$slider=$('<div id="progressSlider"><div class="ui-slider-left"></div><div class="ui-slider-right"></div></div>');this.element.append(this.$slider);this.$slider.slider({animate:175,max:1e3,min:0,orientation:"horizontal",progressbar:true,progress:0,constraintProgress:true,range:"min",value:0});if(this.options.showTime){this.$slider.css({marginRight:"40px"});this.$time=$('<div id="progressTime">00:00</div>');this.element.append(this.$time);this._bindTimeEvent()}},_setTotalTime:function(curSong){var curSong=curSong||this.playList.getCurSong();if(curSong&&curSong.time){this.options.totalTime=curSong.time}else{this.options.totalTime=0}},_bindEvent:function(){var self=this;this.$slider.on("slidestart",function(e,data){self.options.isSliding=true});this.$slider.on("slidestop",function(e,data){if(self.playList.getCurSongIndex()!=-1){self.playCore.setCurrentPosition(data.value*self.options.totalTime)}self.options.isSliding=false});this.playCore.setEventListener(this.playCore.EVENTS.PROGRESS,function(e){self.setProgress(e)});this.playCore.setEventListener(this.playCore.EVENTS.POSITIONCHANGE,function(e){self.setPosition(e.position)});this.options.model.on("change:songLink",function(model,curSong){self._setTotalTime(curSong)});this.element.on({mouseover:function(){$(this).addClass("progress-hover")},mouseout:function(){$(this).removeClass("progress-hover")}})},_bindTimeEvent:function(){var self=this;this.playCore.setEventListener(this.playCore.EVENTS.POSITIONCHANGE,function(e){self.setCurTime(e.position)});this.options.model.on("change:songLink",function(model,curSong){self.setCurTime(0)})},setPosition:function(val){if(this.options.isSliding){return}val/=this.options.totalTime;$(this.$slider).slider("option","value",val)},setProgress:function(e){var val=e.progress||0;$(this.$slider).slider("progress",val*1e3)},setCurTime:function(time){time=convertTime(time);this.$time.text(time)}})}(jQuery)});
/** If u are interested in our code and would like to make it robust, just contact us^^  <enimong#gmail.com> **/
/** Generated by M3D. **/